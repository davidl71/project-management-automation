# Exarp Phase 1 - Follow-up Tasks


> ðŸ’¡ **AI Assistant Hint:** For up-to-date, version-specific documentation on Python, use the Context7 MCP server by appending `use context7` to your prompts. For example:
> - "How do I use Python patterns? use context7"
> - "Show me Python examples examples use context7"
> - "Python best practices 2025 use context7"
>
> Context7 provides current documentation (2025), version-specific API references, and real code examples without hallucinations.

**Date**: 2025-11-26
**Status**: Follow-up Tasks Identified

---

## Phase 1 Follow-up Tasks

### Task 1: Fix Git Hooks Tool MCP Invocation

**Priority**: High (9/10)
**Tags**: exarp, git-hooks, bug-fix, phase1

**Issue**: The git hooks tool generates scripts that try to import Python modules directly, which won't work in git hook context. Git hooks need to either:
1. Call MCP tools via MCP client
2. Call Python scripts directly (scripts/automate_*.py)
3. Use subprocess to invoke exarp tools

**Current Problem**:
```python
# Current approach (won't work):
python3 -c "from tools.check_documentation_health import check_documentation_health; check_documentation_health()"
```

**Solution Options**:
1. **Use existing scripts**: Call `scripts/automate_docs_health.py` instead
2. **MCP client**: Use MCP client library to call tools
3. **Direct script execution**: Create wrapper scripts that can be called from hooks

**Acceptance Criteria**:
- Git hooks actually execute exarp tools correctly
- Hooks work in git hook context (no import errors)
- Tools are invoked with correct parameters
- Error handling works properly

**Files to Update**:
- `mcp-servers/project-management-automation/tools/git_hooks.py` - Fix hook script generation

---

### Task 2: Enhance File Watcher Script

**Priority**: High (8/10)
**Tags**: exarp, file-watchers, enhancement, phase1

**Issue**: The file watcher script generated by `pattern_triggers.py` is just a placeholder. It needs actual file watching implementation.

**Current Problem**:
```python
# Placeholder code:
def check_file_changes() -> List[Dict]:
    """Check for file changes and return matching patterns."""
    # This is a placeholder - implement actual file watching logic
    # For now, returns empty list
    return []
```

**Solution**:
- Use `watchdog` library for cross-platform file watching
- Implement pattern matching using `fnmatch` or `pathlib.Path.match()`
- Add debouncing for rapid file changes
- Implement tool triggering via MCP client or script calls

**Acceptance Criteria**:
- File watcher actually monitors file changes
- Pattern matching works correctly
- Tools are triggered on matching file changes
- Debouncing prevents excessive tool execution
- Works on macOS and Linux

**Files to Update**:
- `mcp-servers/project-management-automation/tools/pattern_triggers.py` - Enhance `_generate_file_watcher_script()`
- May need to add `watchdog` dependency to `pyproject.toml`

---

### Task 3: Test and Refine Simplify Rules Tool

**Priority**: Medium (7/10)
**Tags**: exarp, rule-simplification, testing, phase1

**Issue**: The simplify_rules_tool needs testing and refinement. Pattern matching may need improvement for complex rule structures.

**Current Concerns**:
- Regex patterns may not match all rule variations
- Complex rule structures may not be simplified correctly
- Edge cases in rule files may cause errors

**Testing Needed**:
- Test with actual `.cursorrules` file
- Test with various `.cursor/rules/*.mdc` files
- Test edge cases (empty files, malformed rules, etc.)
- Verify simplifications are correct
- Test dry-run mode

**Acceptance Criteria**:
- Tool correctly identifies simplification opportunities
- Simplifications are accurate and don't break rules
- Handles edge cases gracefully
- Dry-run mode works correctly
- Actual rule updates work correctly

**Files to Update**:
- `mcp-servers/project-management-automation/tools/simplify_rules.py` - Refine patterns and add tests

---

### Task 4: Create Documentation for Phase 1 Tools

**Priority**: Medium (7/10)
**Tags**: exarp, documentation, phase1

**Issue**: No documentation exists for the three new Phase 1 tools.

**Documentation Needed**:
1. **setup_git_hooks_tool**:
   - Usage guide
   - Hook types and their purposes
   - Configuration options
   - Troubleshooting

2. **setup_pattern_triggers_tool**:
   - Pattern configuration guide
   - File pattern syntax
   - Git event triggers
   - Task status triggers
   - Configuration file format

3. **simplify_rules_tool**:
   - Usage guide
   - Simplification patterns
   - Dry-run mode
   - Rule file processing

**Acceptance Criteria**:
- Complete usage documentation for each tool
- Examples for common use cases
- Troubleshooting guides
- Integration examples

**Files to Create**:
- `docs/AUTOMA_GIT_HOOKS_USAGE.md`
- `docs/AUTOMA_PATTERN_TRIGGERS_USAGE.md`
- `docs/AUTOMA_RULE_SIMPLIFICATION_USAGE.md`
- Update `mcp-servers/project-management-automation/USAGE.md`

---

### Task 5: Integration Testing of Phase 1 Tools

**Priority**: High (8/10)
**Tags**: exarp, testing, integration, phase1

**Issue**: No integration testing has been done for the Phase 1 tools together.

**Testing Needed**:
1. **Git Hooks Integration**:
   - Test git hooks actually execute
   - Verify tools are called correctly
   - Test blocking vs non-blocking hooks
   - Test error handling

2. **Pattern Triggers Integration**:
   - Test file pattern matching
   - Test git event triggers
   - Test task status triggers
   - Verify configuration file loading

3. **Rule Simplification Integration**:
   - Test with actual rule files
   - Verify simplifications don't break rules
   - Test dry-run vs actual updates

4. **End-to-End Testing**:
   - Setup git hooks â†’ Test hooks execute
   - Setup pattern triggers â†’ Test file watching
   - Simplify rules â†’ Verify rules updated correctly
   - Test all three tools together

**Acceptance Criteria**:
- All tools work individually
- Tools work together correctly
- Integration doesn't break existing functionality
- Error handling works properly
- Documentation matches actual behavior

**Files to Create**:
- `mcp-servers/project-management-automation/tests/test_phase1_integration.py`

---

## Implementation Order

1. **Fix Git Hooks Tool** (Critical - blocks actual usage)
2. **Enhance File Watcher** (High - needed for real-time automation)
3. **Integration Testing** (High - verify everything works)
4. **Test and Refine Simplify Rules** (Medium - polish)
5. **Create Documentation** (Medium - important for users)

---

## Dependencies

- Task 1 (Git Hooks Fix) â†’ Task 5 (Integration Testing)
- Task 2 (File Watcher) â†’ Task 5 (Integration Testing)
- Task 3 (Simplify Rules) â†’ Task 5 (Integration Testing)
- Task 5 (Integration Testing) â†’ Task 4 (Documentation - needs accurate info)

---

## Success Metrics

### Git Hooks Fix
- Git hooks execute without errors
- Tools are invoked correctly
- Blocking hooks prevent commits when needed

### File Watcher Enhancement
- File changes are detected in real-time
- Pattern matching works correctly
- Tools are triggered automatically

### Simplify Rules Testing
- All simplification patterns work correctly
- Edge cases handled gracefully
- Rules remain valid after simplification

### Documentation
- Complete usage guides for all tools
- Examples work correctly
- Troubleshooting guides helpful

### Integration Testing
- All tools work together
- No conflicts or errors
- End-to-end workflow functional

---

P25-12-25
