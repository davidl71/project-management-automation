import{bt as u,bu as l,bv as x,O as y,j as s,bw as A,bx as b}from"./CategoryPickerMenu.js";import{S as h,b as j,c as f,u as m,d as L,e as R,f as w}from"./SyncRecoilWithAuth.js";import{A as d}from"./AddTask.js";async function U({storage:o,auth:t,renderLoading:g,newTask:r,onIframeClose:c,onSignIn:a}){const e=new h({auth:t,isApplicationActive:j.isWindowActive(),getClientId:u(()=>l(o))});t.isLoggedIn()&&!e.isAfterFirstSync()&&(g(),await new Promise(i=>{const n=e.on("first-sync",()=>{n(),i()})}));const p=new f({auth:t,batch:x.unstable_batchedUpdates});function S(){return e.read()}return{Root:()=>{const i=y(),n=m(i,e);return s.jsx(L,{sync:e,s3UploadManager:p,children:!t.isLoggedIn()||!n?s.jsx(d,{isLoading:t.isLoggedIn()&&!n,newTask:r,onIframeClose:c,onSignIn:a}):s.jsx(A,{children:s.jsx(R,{children:s.jsx(w,{children:s.jsx(b,{isAuthLoggedIn:t.isLoggedIn(),storage:o,getStoreState:S,children:s.jsx(d,{newTask:r,onIframeClose:c,onSignIn:a})})})})},i.userEmail)})}}}export{U as createAppRoot};
