---
description: Testing rules for AI assistance
globs: ["**/test_*.py", "**/*_test.py", "**/*.test.ts", "**/*.spec.ts"]
alwaysApply: false
---

# Testing Rules

## Test Organization

### File Structure
- **One test file per tool/module**: `project_management_automation/tools/automation_opportunities.py` → `tests/test_automation_opportunities.py`
- **Dedicated files for shared utilities**: Shared network utilities → `tests/test_utils_network.py`
- **Avoid duplicate tests**: Never duplicate the same test in multiple files

### Naming Conventions
- Use descriptive test names: `test_find_automation_opportunities_success` (not `test_success`)
- Include context in names to prevent duplicates across files
- Group related tests into test classes: `TestAutomationOpportunitiesTool`

**See:** [Test Organization Guidelines](../../docs/TEST_ORGANIZATION_GUIDELINES.md)

## Test Structure
- Use descriptive test names
- Follow Arrange-Act-Assert pattern
- One assertion per test when possible
- Group related tests into test classes

## Mocking
- Mock external dependencies
- Use dependency injection for testability
- Reset mocks between tests

## Coverage
- Aim for >80% code coverage
- Cover edge cases and error paths
- Test both happy and unhappy paths

## Performance
- Keep tests fast (<1s each)
- Use fixtures for expensive setup
- Run tests in isolation

## Running Tests
- **Always use `uv run pytest`** to run tests
- Never use `pip install` or manual virtual environments
- Example: `uv run pytest tests/ -v`

## Checking for Duplicates
- Run `uv run python scripts/check_duplicate_test_names.py` before committing
- Ensure no duplicate test names across different files
